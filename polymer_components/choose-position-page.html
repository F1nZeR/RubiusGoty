<link rel="import" href="../bower_components/polymer/polymer.html">
<dom-module id="choose-position-page">
    <template>


        <div class="section"></div>
        <main>

            <center>
Hi, {{name}}! You are in Team {{teamId}}
                Choose your position:
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.turret}}"  data-position="turret" on-tap="setPosition">Turret</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.move1}}" data-position="move1" on-tap="setPosition">Move</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.move2}}" data-position="move2" on-tap="setPosition">Move</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.turn1}}" data-position="turn1" on-tap="setPosition">Turn</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.turn2}}" data-position="turn2" on-tap="setPosition">Turn</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.leftTrack}}" data-position="leftTrack" on-tap="setPosition">leftTrack</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.rightTrack}}" data-position="rightTrack" on-tap="setPosition">rightTrack</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.strafe}}" data-position="strafe" on-tap="setPosition">strafe</button>
                </div>
                <div class='row'>
                    <button type='submit' name='btn_login' class='col s12 btn btn-large waves-effect pink' disabled="{{positionsTaken.fire}}" data-position="fire" on-tap="setPosition">fire</button>
                </div>

            </center>



            <div class="section"></div>
            <div class="section"></div>
        </main>

        <change-name></change-name>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'choose-position-page',
        ready: function() {
            CheckClientNavigationShouldExit('choose-position');

            this.name = localStorage.getItem("username");
            var positions = ['turret', 'move','turn','leftTrack','rightTrack','strafe','fire', 'move1', 'move2', 'turn1', 'turn2'];


            var positionsTaken = {
            };
            positions.forEach(function (i) {positionsTaken[i] = true;});
            this.positionsTaken = positionsTaken;

        },
        attached: function() {
            var that = this;
            Sockets.sendJson({type: 'getPositions', team: that.teamId});

            Sockets.UpdateCallback = function () {
                that.set('positionsTaken', Sockets.ViewModel.positionsTaken)
            };
        },
        setPosition: function(e) {
            var position = e.target.dataset.position;
            GoTo('/team/'+this.teamId+'/position/'+position);
        },
    });
</script>